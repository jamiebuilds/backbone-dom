!function(e,t){"function"==typeof define&&define.amd?define(["backbone","underscore","backbone-metal"],t):"undefined"!=typeof exports?module.exports=t(require("backbone"),require("underscore"),require("backbone-metal")):t(e.Backbone,e._,e.Backbone.Metal)}(this,function(e,t,i){"use strict";{var r=(Array.prototype.slice,e.DOM={}),n=r.Error=i.Error.extend({name:"ViewError",urlRoot:"http://github.com/thejameskyle/backbone-dom"}),s=r.utils={parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},insertBefore:function(e,t,i){return e.insertBefore(t,i)},appendChild:function(e,t){return e.appendChild(t)},innerHTML:function(e,t){return t?e.innerHTML=t:e.innerHTML},remove:function(e){if(e.remove)e.remove();else{var t=s.parentNode(e);t.removeChild(e)}},querySelector:function(e,t){return e.querySelector(t)}};r.View=e.View.extend({constructor:function(e){void 0===e&&(e={}),e.template&&(this.template=e.template),this.children={},this._super.apply(this,arguments)},compile:function(){if(this.template){var e=this.serializeData();return this.template(e)}},render:function(){if(this._isDestroyed)throw new n("Views cannot be rendered after they have been destroyed.");this.triggerMethod("before:render");var e=this.compile();if(e===s.innerHTML(this.el))return this;var i=s.parentNode(this.el),r=s.nextSibling(this.el);return i&&this._isAttached&&this.detach(),s.innerHTML(this.el,e),this._regions=t.result(this,"regions"),i&&!this._isAttached&&this.attach(i,r),this._isRendered=!0,this.triggerMethod("render"),this},attach:function(e,t){if(this._isDestroyed)throw new n("Views cannot be attached after they have been destroyed.");return this.triggerMethod("before:attach"),this._isAttached?this:(t?s.insertBefore(e,this.el,t):s.appendChild(e,this.el),this.attachChildren(),this._isAttached=!0,this.triggerMethod("attach"),this)},attachChildren:function(){return t.each(this._regions,function(e,t){var i=s.querySelector(this.el,regions[t]);e.attach(i)}),this},detach:function(){if(this._isDestroyed)throw new n("Views cannot be detached after they have been destroyed.");return this.triggerMethod("before:detach"),this._isAttached?(s.remove(this.el),this.detachChildren(),this._isAttached=!1,this.triggerMethod("detach"),this):this},detachChildren:function(){return t.invoke(this._regions,"detach"),this},destroy:function(){if(this._isDestroyed)throw new n("Views cannot be destroyed more than once.");return this.triggerMethod("before:destroy"),this.detach(this.el),s.innerHTML(this.el,""),this.stopListening(),delete this.el,delete this.$el,this._isRendered=!1,this._isDestroyed=!0,this.triggerMethod("destroy"),this},serializeData:function(){return this.model?this.serializeModel(this.model):this.collection?this.serializeCollection(this.collection):void 0},serializeModel:function(e){return t.clone(e.attributes)},serializeCollection:function(e){return{items:t.map(e.models,this.serializeModel,this)}},insertChild:function(e,t){this._children[e]=t},removeChild:function(e){this._children[e]=null},isRendered:function(){return this._isRendered===!0},isDestroyed:function(){return this._isDestroyed===!0},isAttached:function(){return this._isAttached===!0}})}return t.mixin({isView:function(t){return!!t&&(t instanceof e.View||t.prototype instanceof e.View)}}),r});
//# sourceMappingURL=backbone-dom.min.js.map